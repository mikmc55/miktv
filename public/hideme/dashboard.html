<!DOCTYPE html>
<html>
<head>
    <title>IPTV Connections</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Add Toastr CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
    <!-- Add jQuery (required for Toastr) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- Add Toastr JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
</head>
<body class="bg-gray-100">
    <div class="max-w-7xl mx-auto p-4">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-bold">IPTV Connections</h1>
            <div class="space-x-2">
                <button onclick="loadConnections()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                    </svg>
                    Refresh
                </button>
                <button onclick="showAddForm()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Add Connection</button>
                <a href="/hideme/admin.html" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Admin</a>
                <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Logout</button>
            </div>
        </div>

        <!-- Connection List -->
        <div class="bg-white rounded-lg shadow overflow-x-auto">
            <table class="min-w-full" id="connectionTable">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-2 text-left">Name</th>
                        <th class="px-4 py-2 text-left">Target URL</th>
                        <th class="px-4 py-2 text-left">Target Username</th>
                        <th class="px-4 py-2 text-left">Target Password</th>
                        <th class="px-4 py-2 text-left">IPTV Username</th>
                        <th class="px-4 py-2 text-left">IPTV Password</th>
                        <th class="px-4 py-2 text-left">Expire Date</th>
                        <th class="px-4 py-2 text-left">Actions</th>
                    </tr>
                </thead>
                <tbody id="connectionsList">
                </tbody>
            </table>
        </div>

        <!-- Add/Edit Form Modal -->
        <div id="addForm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
            <div class="bg-white p-6 rounded-lg w-full max-w-xl">
                <h2 class="text-xl font-bold mb-4" id="formTitle">Add IPTV Connection</h2>
                <form id="connectionForm" class="space-y-4">
                    <input type="hidden" name="id" id="connectionId">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Name</label>
                            <input type="text" name="name" required class="w-full px-3 py-2 border rounded focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Target URL</label>
                            <input type="text" name="targetUrl" required class="w-full px-3 py-2 border rounded focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Target Username</label>
                            <input type="text" name="targetUsername" required class="w-full px-3 py-2 border rounded focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Target Password</label>
                            <input type="text" name="targetPassword" required class="w-full px-3 py-2 border rounded focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">IPTV Username</label>
                            <input type="text" name="iptvUsername" required class="w-full px-3 py-2 border rounded focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">IPTV Password</label>
                            <input type="text" name="iptvPassword" required class="w-full px-3 py-2 border rounded focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Expire Date</label>
                            <input type="text" name="expireDate" class="w-full px-3 py-2 border rounded datepicker focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="flex justify-end gap-2">
                        <button type="button" onclick="hideAddForm()" class="px-4 py-2 border rounded hover:bg-gray-100">Cancel</button>
                        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600" id="submitButton">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src="/js/main.js"></script>
</body>
</html>